<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸ’¥ ìš•ì„¤ ë³€í™˜ê¸° + ê¸°ë¡ ë° ë‚´ ê¸°ë¡ ê³µìœ  ê¸°ëŠ¥ ğŸ’¥</title>
<style>
  body {
    font-family: -apple-system, BlinkMacSystem, "Apple SD Gothic Neo", Pretendard, Roboto, "Noto Sans KR", "Segoe UI", "Malgun Gothic", sans-serif;
    margin: 0; height: 100vh;
    background: linear-gradient(135deg, #74b9ff, #a29bfe);
    display: flex; justify-content: center; align-items: center;
    padding: 10px; box-sizing: border-box; color: #2c3e50;
  }
  .container {
    display: flex;
    max-width: 1100px;
    width: 100%;
    background: #ffffffdd;
    backdrop-filter: blur(6px);
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    box-sizing: border-box;
  }
  .left-pane { flex: 1.5; padding: 40px 35px; box-sizing: border-box; display: flex; flex-direction: column; align-items: center; border-right: 2px solid #d2d2d2; }
  .right-pane { flex: 1; display: flex; flex-direction: column; padding: 40px 35px; box-sizing: border-box; }
  h1 { font-size: 30px; margin-bottom: 15px; text-align: center; }
  p { font-size: 16px; margin-bottom: 30px; text-align: center; }
  textarea {
    width: 100%; padding: 14px; margin-bottom: 20px; font-size: 16px;
    border: 2px solid #dfe6e9; border-radius: 10px; resize: vertical; outline: none; min-height: 100px;
    box-sizing: border-box; white-space: pre-wrap; word-break: break-word;
  }
  textarea:focus { border-color: #0984e3; }
  .controls {
    display: flex; flex-wrap: wrap; justify-content: center; align-items: center;
    margin-bottom: 25px; gap: 10px; width: 100%;
  }
  .controls label { font-size: 16px; color: #2d3436; font-weight: 500; white-space: nowrap; }
  .controls select {
    padding: 8px 12px; font-size: 16px; border-radius: 8px;
    border: 1px solid #b2bec3; background-color: #fff;
    outline: none; cursor: pointer; min-width: 120px; box-sizing: border-box;
  }
  button {
    padding: 14px 30px; font-size: 17px; font-weight: bold;
    background: linear-gradient(90deg, #0984e3, #6c5ce7);
    color: #fff; border: none; border-radius: 12px; cursor: pointer;
    transition: transform 0.15s ease, box-shadow 0.2s ease;
    min-width: 120px; box-sizing: border-box;
  }
  button:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(0,0,0,0.15);
  }
  #output-wrapper {
    margin-top: 30px; text-align: left; width: 100%; box-sizing: border-box;
  }
  #output-title {
    font-size: 18px; color: #2d3436; margin-bottom: 10px; font-weight: 600;
  }
  #output {
    font-size: 28px; font-weight: bold; color: #0984e3; white-space: pre-wrap;
    background-color: #f1f2f6; padding: 20px; border-radius: 12px; min-height: 70px; box-sizing: border-box;
  }
  .history-section { flex: 1; margin-bottom: 20px; display: flex; flex-direction: column; }
  .history-title { font-weight: 700; font-size: 20px; margin-bottom: 12px; border-bottom: 2px solid #636e72; padding-bottom: 8px; }
  #history-list {
    border: 1px solid #dfe6e9;
    border-radius: 10px; padding: 10px; background: #fff;
    max-height: 140px;
    min-height: 45px;
    box-sizing: border-box;
    overflow-y: auto;
  }
  #my-record-list {
    overflow-y: auto; flex: 1; border: 1px solid #dfe6e9;
    border-radius: 10px; padding: 10px; background: #fff;
    max-height: 330px;
  }
  .history-item, .my-record-item {
    border-bottom: 1px solid #eee; padding: 8px 4px;
    display: flex; flex-direction: column; gap: 3px;
    font-size: 14px; position: relative;
  }
  .history-item:last-child, .my-record-item:last-child { border-bottom: none; }
  .history-texts { display: flex; justify-content: space-between; align-items: center; }
  .history-texts div { flex: 1; overflow-wrap: break-word; word-break: break-word; }
  .myrecord-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }
  .myrecord-text {
    flex: 1; word-break: break-all;
    margin-right: 10px;
  }
  .myrecord-btns {
    display: flex; flex-shrink: 0;
    gap: 7px;
  }
  .btn-edit, .btn-delete {
    padding: 7px 22px; font-size: 15px; cursor: pointer; border-radius: 6px; border: none; color: white; min-width:60px;
  }
  .btn-edit { background: #0984e3;}
  .btn-delete { background: #d63031;}
  .btn-edit:hover { background: #6c5ce7;}
  .btn-delete:hover { background: #d90429;}
  #my-records-input {
    margin-top: 8px; display: flex; gap: 8px; flex-wrap: wrap;
  }
  #my-record-input-original, #my-record-input-replaced {
    flex: 1 1 45%; padding: 8px 12px; font-size: 15px; border: 1px solid #ccc; border-radius: 10px; outline: none;
  }
  #my-record-add-btn {
    padding: 8px 18px; font-size: 15px; cursor: pointer; background-color: #0984e3; color: white; border: none; border-radius: 10px;
    transition: background-color 0.3s ease; flex: 1 1 8%; min-width: 60px;
  }
  #my-record-add-btn:hover { background-color: #6c5ce7; }
  #btn-copy-my-records {
    margin-top: 12px; padding: 10px 0; cursor: pointer; background: #0984e3; color: white;
    font-weight: bold; border-radius: 10px; border: none; user-select: none; transition: background 0.3s ease;
  }
  #btn-copy-my-records:hover { background: #6c5ce7; }
  /* ----- ëª¨ë°”ì¼ ê°œì„  ----- */
  @media (max-width: 480px) {
    body {
      min-width: 320px;
      padding: 0;
    }
    .container {
      flex-direction: column;
      height: auto;
      border-radius: 0;
      box-shadow: none;
      max-width: 100vw;
      width: 100vw;
      margin: 0;
    }
    .left-pane, .right-pane {
      width: 100vw !important;
      min-width: 100vw;
      padding: 15px 5vw;
      border: none;
      margin-bottom: 0;
      box-sizing: border-box;
    }
    h1 {
      font-size: 22px;
      margin-bottom: 10px;
    }
    p {
      font-size: 12px;
      margin-bottom: 15px;
    }
    textarea {
      font-size: 14px;
      padding: 10px;
      min-height: 60px;
      box-sizing: border-box;
    }
    .controls {
      flex-direction: column;
      gap: 5px;
      margin-bottom: 15px;
      align-items: stretch;
    }
    button, select {
      font-size: 15px;
      min-width: unset;
      width: 100%;
    }
    #output {
      font-size: 17px;
      padding: 14px;
      min-height: 44px;
    }
    .history-title {
      font-size: 15px;
      padding-bottom: 6px;
    }
    #history-list, #my-record-list {
      max-height: 100px;
      font-size: 13px;
      padding: 7px;
    }
    #my-records-input {
      flex-direction: column;
      gap: 4px;
    }
    #my-record-input-original, #my-record-input-replaced {
      padding: 6px 8px;
      font-size: 13px;
    }
  }
</style>
</head>
<body>
<div class="container">
  <div class="left-pane">
    <h1>ğŸ’¥ ìš•ì„¤ ë³€í™˜ê¸° ğŸ’¥</h1>
    <p>ë‚´ê°€, ë„ˆê°€, ê·¸ë¦¬ê³  ìš°ë¦¬ê°€ ë§Œë“¤ì–´ ê°€ë³´ìêµ¬ ğŸ¶</p>
    <textarea id="inputText" rows="4" placeholder="ì—¬ê¸°ì— ë¬¸ì¥ì„ ì…ë ¥í•´ ë³´ì„¸ìš”..."></textarea>
    <div class="controls">
      <label for="wordLengthSelect">ê¸€ì ìˆ˜:</label>
      <select id="wordLengthSelect">
        <option value="random">ë¬´ì‘ìœ„</option>
        <option value="1">1ê¸€ì</option>
        <option value="2">2ê¸€ì</option>
        <option value="3">3ê¸€ì</option>
        <option value="4">4ê¸€ì</option>
      </select>
      <button id="convertBtn">ğŸš€ ë³€í™˜í•˜ê¸°</button>
    </div>
    <div id="output-wrapper">
      <div id="output-title">âœ¨ ê²°ê³¼:</div>
      <div id="output"></div>
      <button id="btn-add-my-record" style="display:none; margin-top:10px;">â• ë‚´ ê¸°ë¡ì— ì¶”ê°€í•˜ê¸°</button>
    </div>
  </div>
  <div class="right-pane">
    <div class="history-section">
      <div class="history-title">ğŸ“ ë³€í™˜ ê¸°ë¡</div>
      <div id="history-list"></div>
    </div>
    <div class="history-section">
      <div class="history-title">ğŸ“‹ ë‚´ ê¸°ë¡</div>
      <div id="my-record-list"></div>
      <div id="my-records-input">
        <input type="text" id="my-record-input-original" placeholder="ì›ë˜ ìš•ì„¤ ì…ë ¥" />
        <input type="text" id="my-record-input-replaced" placeholder="ë³€í™˜ì–´ ì…ë ¥" />
        <button id="my-record-add-btn">â• ì¶”ê°€</button>
      </div>
      <button id="btn-copy-my-records" title="ë‚´ ê¸°ë¡ URL ë³µì‚¬í•˜ê¸°">ğŸ“ ë‚´ ê¸°ë¡ URL ë³µì‚¬í•˜ê¸°</button>
    </div>
  </div>
</div>
<script>
const swearWords = [
  'ì”¨ë°œ','ì”¨ë°œë…„','ì‹œë°œ','ì‹œë°œë…„','ê°œìƒˆë¼','ë³‘ì‹ ','ì¡´ë‚˜','ì…','ê°œì¢†ê°™ë„¤','ì¢†ê°™ë„¤','ì¢†',
  'ëŠê¸ˆë§ˆ','ë‹ˆë¯¸','ì¢‡ê°™ë„¤','ê°œì¢‡ê°™ë„¤','ì¢‡ê°™ì€','ì¢‡ë§Œì´','ì¢†ë§Œì´'
];
const firstSoundMap = {
  'ì”¨ë°œ': ['ìŒ‰','ìŒ”','ì´','ìƒ¤','ì‹¸','ìŒ°','ì˜','ì‘¤'],
  'ì”¨ë°œë…„': ['ìŒ','ìŒ€','ìŒ°','ì“©','ì½','ì‹¸'],
  'ì…': ['ì‘','ì½','ì‘¤','ì”½'],
  'ê°œìƒˆë¼': ['ê¹”','ê»„','ê¿','ê½','êº„','ê¾œ','ê»´'],
  'ë³‘ì‹ ': ['ë¹¡','ë»‘','ë¹µ','ë¿œ'],
  'ì¡´ë‚˜': ['ì«™','ì­‰','ì­ˆ','ìª½','ì°Ÿ'],
  'ì‹œë°œ': ['ìŒ‰','ìŒ”','ì´','ìƒ¤','ì‹¸','ìŒ°','ì˜','ì‘¤'],
  'ì‹œë°œë…„': ['ìŒ','ìŒ€','ìŒ°','ì“©','ì½','ì‹¸'],
  'ê°œì¢†ê°™ë„¤': ['ê¹¨','ë¼','ë‹¤','ë”°','ë ','ë•…','ë–µ'],
  'ì¢†ê°™ë„¤': ['ë‹¤','ë”°','ë ','ë•…','ë–µ','ëµ'],
  'ì¢†': ['ë”°','ëšœ','ë˜','ë•…','ë–µ','ëµ'],
  'ëŠê¸ˆë§ˆ': ['ë¯¸','ë¨¸','ê²¨','ê°¸','êµ'],
  'ë‹ˆë¯¸': ['ë§ˆ','ë¬´','ë‹˜','ë‹','ë‹'],
  'ì¢‡ê°™ë„¤': ['ë”°','ë˜','ë•','ëµ','í……'],
  'ê°œì¢‡ê°™ë„¤': ['êº„','ê»´','ë¼','ì¿„','ê¾œ'],
  'ì¢‡ê°™ì€': ['ë„','ë˜','ë•…','ëµ'],
  'ì¢‡ë§Œì´': ['ë•¡','ëš±','ë–µ','ë ','ë”°'],
  'ì¢†ë§Œì´': ['ë˜','ë ','ë”°','ëµ','ë–µ']
};
const onsetConsonants = ['ã…‹','ã…','ã……','ã…ˆ','ã„±','ã„·','ã…‚','ã„´','ã„¹'];
const vowels = ['ã…','ã…“','ã…—','ã…œ','ã…¡','ã…£','ã…','ã…”','ã…š','ã…˜','ã…™'];
const codaConsonants = ['', 'ã„±', 'ã„´', 'ã…', 'ã…‡', 'ã…‚', 'ã„¹'];
const forbiddenPatterns = [/ê°€ìŠ´/, /ìì§€/, /ë³´ì§€/, /ì„¹ìŠ¤/, /ì…ìŠ¤/, /ì„¹/, /sex/i, /ì„¹ì“°/, /ê¼¬ì¶”/, /ê³ ì¶”/];
function makeHangulSyllable(cho,jung,jong){
  const choList=['ã„±','ã„²','ã„´','ã„·','ã„¸','ã„¹','ã…','ã…‚','ã…ƒ','ã……','ã…†','ã…‡','ã…ˆ','ã…‰','ã…Š','ã…‹','ã…Œ','ã…','ã…'];
  const jungList=['ã…','ã…','ã…‘','ã…’','ã…“','ã…”','ã…•','ã…–','ã…—','ã…˜','ã…™','ã…š','ã…›','ã…œ','ã…','ã…','ã…Ÿ','ã… ','ã…¡','ã…¢','ã…£'];
  const jongList=['','ã„±','ã„²','ã„³','ã„´','ã„µ','ã„¶','ã„·','ã„¹','ã„º','ã„»','ã„¼','ã„½','ã„¾','ã„¿','ã…€','ã…','ã…‚','ã…„','ã……','ã…†','ã…‡','ã…ˆ','ã…Š','ã…‹','ã…Œ','ã…','ã…'];
  const choIndex=choList.indexOf(cho);
  const jungIndex=jungList.indexOf(jung);
  const jongIndex=jongList.indexOf(jong);
  if(choIndex<0||jungIndex<0||jongIndex<0) return 'ë¼';
  return String.fromCharCode(0xAC00+choIndex*21*28+jungIndex*28+jongIndex);
}
function isForbiddenWord(word){
  return forbiddenPatterns.some(p=>p.test(word));
}
function generateNewWord(lengthOption, swearWord){
  let wordLength = (lengthOption==='random') ? Math.floor(Math.random()*4)+1 : parseInt(lengthOption);
  if(isNaN(wordLength) || wordLength < 1) wordLength = 2;
  const maxAttempts = 100;
  for(let attempt=0; attempt < maxAttempts; attempt++){
    let word = '';
    for(let i=0; i<wordLength; i++){
      const cho=onsetConsonants[Math.floor(Math.random()*onsetConsonants.length)];
      const jung=vowels[Math.floor(Math.random()*vowels.length)];
      const jong=(i===wordLength-1 && Math.random()<0.5) ? codaConsonants[Math.floor(Math.random()*codaConsonants.length)] : '';
      word += makeHangulSyllable(cho,jung,jong);
    }
    if(firstSoundMap[swearWord]){
      word = firstSoundMap[swearWord][Math.floor(Math.random()*firstSoundMap[swearWord].length)] + word.slice(1);
    }
    if(word.includes('ë…„')) continue;
    if(isForbiddenWord(word)) continue;
    return word;
  }
  return Array(wordLength).fill('ê°€').join('');
}
const inputText = document.getElementById('inputText');
const wordLengthSelect = document.getElementById('wordLengthSelect');
const convertBtn = document.getElementById('convertBtn');
const outputDiv = document.getElementById('output');
const btnAddMyRecord = document.getElementById('btn-add-my-record');
const historyList = document.getElementById('history-list');
const myRecordList = document.getElementById('my-record-list');
const myRecordInputOriginal = document.getElementById('my-record-input-original');
const myRecordInputReplaced = document.getElementById('my-record-input-replaced');
const myRecordAddBtn = document.getElementById('my-record-add-btn');
const btnCopyMyRecords = document.getElementById('btn-copy-my-records');
let latestOriginal = '';
let latestReplacement = '';
function addHistoryItem(original, replaced){
  if(historyList.children.length >= 30){
    historyList.removeChild(historyList.lastChild);
  }
  const div = document.createElement('div');
  div.className = 'history-item';
  div.innerHTML = `<div class="history-texts"><div>${original}</div><div style="color:#0984e3">${replaced}</div></div>`;
  historyList.prepend(div);
}
function addMyRecordItem(original, replaced){
  if(!original || !replaced) return;
  const text = `${original} â†’ ${replaced}`;
  for(let item of myRecordList.children){
    if(item.textContent === text) return;
  }
  if(myRecordList.children.length >= 30) myRecordList.removeChild(myRecordList.lastChild);
  const div = document.createElement('div');
  div.className = 'my-record-item';
  div.style.position = 'relative';
  const textDiv = document.createElement('div');
  textDiv.textContent = text;
  textDiv.style.marginRight = '100px';
  div.appendChild(textDiv);
  const btnsDiv = document.createElement('div');
  btnsDiv.style.position = 'absolute';
  btnsDiv.style.top = '5px';
  btnsDiv.style.right = '5px';
  btnsDiv.style.display = 'flex';
  btnsDiv.style.gap = '5px';
  const btnEdit = document.createElement('button');
  btnEdit.className = 'btn-edit';
  btnEdit.textContent = 'ìˆ˜ì •';
  btnEdit.style.minWidth = '60px';
  btnEdit.addEventListener('click', () => {
    const newOriginal = prompt('ì›ë³¸ í…ìŠ¤íŠ¸ ìˆ˜ì •', original);
    if(newOriginal === null) return;
    const newReplaced = prompt('ë³€í™˜ í…ìŠ¤íŠ¸ ìˆ˜ì •', replaced);
    if(newReplaced === null) return;
    if(newOriginal.trim() && newReplaced.trim()){
      textDiv.textContent = `${newOriginal.trim()} â†’ ${newReplaced.trim()}`;
      div.dataset.original = newOriginal.trim();
      div.dataset.replaced = newReplaced.trim();
    }
  });
  btnsDiv.appendChild(btnEdit);
  const btnDelete = document.createElement('button');
  btnDelete.className = 'btn-delete';
  btnDelete.textContent = 'ì‚­ì œ';
  btnDelete.style.minWidth = '60px';
  btnDelete.addEventListener('click', () => {
    myRecordList.removeChild(div);
  });
  btnsDiv.appendChild(btnDelete);
  div.appendChild(btnsDiv);
  myRecordList.prepend(div);
}
convertBtn.addEventListener('click', () => {
  const text = inputText.value.trim();
  if(!text){
    outputDiv.textContent = 'ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!';
    btnAddMyRecord.style.display = 'none';
    return;
  }
  const sortedSwears = [...swearWords].sort((a,b) => b.length - a.length);
  let replaced = text;
  sortedSwears.forEach(word => {
    const regex = new RegExp(word, 'gi');
    replaced = replaced.replace(regex, () => generateNewWord(wordLengthSelect.value, word));
  });
  outputDiv.textContent = replaced;
  latestOriginal = text;
  latestReplacement = replaced;
  btnAddMyRecord.style.display = 'inline-block';
  addHistoryItem(text, replaced);
});
btnAddMyRecord.addEventListener('click', () => {
  if(latestOriginal && latestReplacement){
    addMyRecordItem(latestOriginal, latestReplacement);
    btnAddMyRecord.style.display = 'none';
  }
});
myRecordAddBtn.addEventListener('click', () => {
  const ori = myRecordInputOriginal.value.trim();
  const rep = myRecordInputReplaced.value.trim();
  if(!ori || !rep){
    alert('ì›ë˜ ìš•ì„¤ê³¼ ë³€í™˜ì–´ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.');
    return;
  }
  addMyRecordItem(ori, rep);
  myRecordInputOriginal.value = '';
  myRecordInputReplaced.value = '';
});

// ---- í•µì‹¬ ì¶”ê°€: URL ì§§ê²Œ (Base64) ----
function encodeRecordsShort(records) {
  // ë¬¸ìì—´ â†’ base64 â†’ (íŠ¹ìˆ˜ë¬¸ì ì•ˆì „ì¹˜í™˜)
  return btoa(unescape(encodeURIComponent(records.join('\n'))))
    .replace(/\+/g, '-').replace(/\//g,'_').replace(/=+$/,'');
}
function decodeRecordsShort(str) {
  try {
    return decodeURIComponent(escape(atob(str.replace(/-/g,'+').replace(/_/g,'/')))).split('\n');
  } catch(e) { return []; }
}
btnCopyMyRecords.addEventListener('click', () => {
  if(myRecordList.children.length === 0){
    alert('ë‚´ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.');
    return;
  }
  const records = [];
  for(let item of myRecordList.children){
    records.push(item.textContent);
  }
  // Base64 ì¸ì½”ë“œë¡œ ì¶•ì•½
  const recordId = encodeRecordsShort(records);
  const url = location.origin + location.pathname + '?myRecords=' + recordId;
  navigator.clipboard.writeText(url)
    .then(() => alert('ë‚´ ê¸°ë¡ URLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.'))
    .catch(() => alert('ë³µì‚¬ ì‹¤íŒ¨'));
});
window.addEventListener('load', () => {
  const params = new URLSearchParams(location.search);
  const myRecordsStr = params.get('myRecords');
  if(myRecordsStr){
    try {
      const stored = decodeRecordsShort(myRecordsStr);
      stored.slice(-30).forEach(text => {
        const [ori, rep] = text.split('â†’').map(s => s.trim());
        if(ori && rep) addMyRecordItem(ori, rep);
      });
    } catch(e) { console.error("ë‚´ ê¸°ë¡ ë¡œë“œ ì‹¤íŒ¨", e); }
  }
});
</script>
</body>
</html>
