<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ğŸ’¥ ìš•ì„¤ ë³€í™˜ê¸° ğŸ’¥</title>
<style>
  html, body {
    width: 100%;
    min-height: 100vh;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  body {
    background: linear-gradient(135deg, #74b9ff, #a29bfe);
    min-height: 100vh;
    width: 100vw;
    color: #2c3e50;
    overflow-y: auto;
  }
  .container {
    display: flex;
    min-height: 100vh;
    max-width: 1100px;
    margin: 0 auto;
    background: #ffffffdd;
    backdrop-filter: blur(6px);
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
  }
  .left-pane { flex: 1.5; padding: 40px 35px; display: flex; flex-direction: column; align-items: center; border-right: 2px solid #d2d2d2; }
  .right-pane { flex: 1; display: flex; flex-direction: column; padding: 40px 35px; }
  h1 { font-size: 30px; margin-bottom: 15px; text-align: center; }
  p { font-size: 16px; margin-bottom: 30px; text-align: center; }
  textarea {
    width: 100%; padding: 14px; margin-bottom: 20px; font-size: 16px;
    border: 2px solid #dfe6e9; border-radius: 10px; resize: vertical; outline: none; min-height: 100px;
  }
  textarea:focus { border-color: #0984e3; }
  .controls { display: flex; gap: 12px; align-items: center; margin-bottom: 25px; }
  select {
    padding: 8px 12px; font-size: 15px; border-radius: 8px; border: 1px solid #b2bec3;
  }
  button {
    font-size: 16px; font-weight: bold;
    background: linear-gradient(90deg, #0984e3, #6c5ce7);
    color: #fff; border: none; border-radius: 10px; cursor: pointer;
    padding: 12px 20px;
    transition: 0.2s;
  }
  button:hover { transform: translateY(-2px); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
  #output-wrapper { margin-top: 30px; width: 100%; }
  #output { font-size: 24px; font-weight: bold; color: #0984e3;
    background: #f1f2f6; padding: 18px; border-radius: 10px; min-height: 60px; }
  .history-section { margin-bottom: 24px; display: flex; flex-direction: column; }
  .history-title { font-weight: bold; font-size: 18px; margin-bottom: 12px; border-bottom: 2px solid #636e72; padding-bottom: 6px; }
  /* ë‚´ ê¸°ë¡ ì…ë ¥í¼ */
  #my-records-form { display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px; }
  #my-records-form input[type="text"] {
    padding: 9px 12px; font-size: 14px; border: 1px solid #b2bec3; border-radius: 8px;
  }
  #my-records-btns { display: flex; gap: 8px; }
  #my-record-list, #history-list {
    margin-top: 10px;
    padding: 10px;
    background: #f9fbff;
    border-radius: 10px;
    min-height: 60px;
    max-height: 150px;
    overflow-y: auto;
  }
  .my-record-item, .history-item {
    border-bottom: 1px solid #eee;
    padding: 6px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .my-record-item:last-child, .history-item:last-child { border-bottom: none; }
  .myrecord-text { flex: 1; word-break: break-all; margin-right: 10px; }
  .myrecord-btns { display: flex; gap: 6px; flex-shrink: 0;}
  .btn-edit, .btn-delete {
    font-size: 13px; padding: 5px 12px; border-radius: 6px; border: none; cursor: pointer; color: #fff;
  }
  .btn-edit { background: #0984e3; }
  .btn-edit:hover { background: #6c5ce7; }
  .btn-delete { background: #d63031; }
  .btn-delete:hover { background: #b32020; }
  /* ëª¨ë°”ì¼ */
  @media (max-width: 480px){
    .container { flex-direction: column; width: 100vw; border-radius: 0; }
    .left-pane, .right-pane { width: 100%; padding: 20px; border: none; }
    #output { font-size: 18px; }
  }
</style>
</head>
<body>
<div class="container">
  <div class="left-pane">
    <h1>ğŸ’¥ ìš•ì„¤ ë³€í™˜ê¸° ğŸ’¥</h1>
    <p>ë‚´ê°€, ë„ˆê°€, ê·¸ë¦¬ê³  ìš°ë¦¬ê°€ ë§Œë“¤ì–´ ê°€ë³´ìêµ¬ ğŸ¶</p>
    <textarea id="inputText" placeholder="ì—¬ê¸°ì— ë¬¸ì¥ì„ ì…ë ¥í•´ ë³´ì„¸ìš”..."></textarea>
    <div class="controls">
      <label for="wordLengthSelect">ê¸€ì ìˆ˜:</label>
      <select id="wordLengthSelect">
        <option value="random">ë¬´ì‘ìœ„</option>
        <option value="1">1ê¸€ì</option>
        <option value="2">2ê¸€ì</option>
        <option value="3">3ê¸€ì</option>
        <option value="4">4ê¸€ì</option>
      </select>
      <button id="convertBtn">ğŸš€ ë³€í™˜í•˜ê¸°</button>
    </div>
    <div id="output-wrapper">
      <div>âœ¨ ê²°ê³¼:</div>
      <div id="output"></div>
      <button id="btn-add-my-record" style="display:none;">â• ë‚´ ê¸°ë¡ì— ì¶”ê°€í•˜ê¸°</button>
    </div>
  </div>
  <div class="right-pane">
    <div class="history-section">
      <div class="history-title">ğŸ“‹ ë‚´ ê¸°ë¡</div>
      <div id="my-records-form">
        <input type="text" id="nicknameInput" placeholder="ë‹‰ë„¤ì„ (ì˜ˆ: ì² ìˆ˜)" />
        <input type="text" id="my-record-input-original" placeholder="ì›ë˜ ìš•ì„¤ ì…ë ¥" />
        <input type="text" id="my-record-input-replaced" placeholder="ë³€í™˜ì–´ ì…ë ¥" />
        <div id="my-records-btns">
          <button id="my-record-add-btn">â• ì¶”ê°€</button>
          <button id="btn-copy-my-records">ğŸ“ ë‚´ ê¸°ë¡ URL ë³µì‚¬í•˜ê¸°</button>
        </div>
      </div>
      <div id="my-record-list"></div>
    </div>
    <div class="history-section">
      <div class="history-title">ğŸ“ ë³€í™˜ ê¸°ë¡</div>
      <div id="history-list"></div>
    </div>
  </div>
</div>

<script>
const swearWords = ['ì”¨ë°œ','ì”¨ë°œë…„','ì‹œë°œ','ì‹œë°œë…„','ê°œìƒˆë¼','ë³‘ì‹ ','ì¡´ë‚˜','ì…','ê°œì¢†ê°™ë„¤','ì¢†ê°™ë„¤','ì¢†','ëŠê¸ˆë§ˆ','ë‹ˆë¯¸','ì¢‡ê°™ë„¤','ê°œì¢‡ê°™ë„¤','ì¢‡ê°™ì€','ì¢‡ë§Œì´','ì¢†ë§Œì´'];
const onsetConsonants=['ã…‹','ã…','ã……','ã…ˆ','ã„±','ã„·','ã…‚','ã„´','ã„¹'];
const vowels=['ã…','ã…“','ã…—','ã…œ','ã…¡','ã…£','ã…','ã…”','ã…š','ã…˜','ã…™'];
const codaConsonants=['','ã„±','ã„´','ã…','ã…‡','ã…‚','ã„¹'];
function makeHangulSyllable(cho,jung,jong){
  const choList=['ã„±','ã„²','ã„´','ã„·','ã„¸','ã„¹','ã…','ã…‚','ã…ƒ','ã……','ã…†','ã…‡','ã…ˆ','ã…‰','ã…Š','ã…‹','ã…Œ','ã…','ã…'];
  const jungList=['ã…','ã…','ã…‘','ã…’','ã…“','ã…”','ã…•','ã…–','ã…—','ã…˜','ã…™','ã…š','ã…›','ã…œ','ã…','ã…','ã…Ÿ','ã… ','ã…¡','ã…¢','ã…£'];
  const jongList=['','ã„±','ã„²','ã„³','ã„´','ã„µ','ã„¶','ã„·','ã„¹','ã„º','ã„»','ã„¼','ã„½','ã„¾','ã„¿','ã…€','ã…','ã…‚','ã…„','ã……','ã…†','ã…‡','ã…ˆ','ã…Š','ã…‹','ã…Œ','ã…','ã…'];
  return String.fromCharCode(0xAC00+choList.indexOf(cho)*21*28+jungList.indexOf(jung)*28+jongList.indexOf(jong));
}
function generateNewWord(lengthOption){
  let wordLength=(lengthOption==='random')?Math.floor(Math.random()*4)+1:parseInt(lengthOption);
  if(isNaN(wordLength)||wordLength<1) wordLength=2;
  let word='';
  for(let i=0;i<wordLength;i++){
    const cho=onsetConsonants[Math.floor(Math.random()*onsetConsonants.length)];
    const jung=vowels[Math.floor(Math.random()*vowels.length)];
    const jong=(i===wordLength-1&&Math.random()<0.5)?codaConsonants[Math.floor(Math.random()*codaConsonants.length)]:'';
    word+=makeHangulSyllable(cho,jung,jong);
  }
  return word;
}
const inputText=document.getElementById('inputText');
const wordLengthSelect=document.getElementById('wordLengthSelect');
const convertBtn=document.getElementById('convertBtn');
const outputDiv=document.getElementById('output');
const btnAddMyRecord=document.getElementById('btn-add-my-record');
const historyList=document.getElementById('history-list');
const myRecordList=document.getElementById('my-record-list');
const myRecordInputOriginal=document.getElementById('my-record-input-original');
const myRecordInputReplaced=document.getElementById('my-record-input-replaced');
const myRecordAddBtn=document.getElementById('my-record-add-btn');
const btnCopyMyRecords=document.getElementById('btn-copy-my-records');
const nicknameInput=document.getElementById('nicknameInput');

function addHistoryItem(original,replaced){
  const div=document.createElement('div');
  div.className='history-item';
  div.innerHTML=`${original} â†’ <span>${replaced}</span>`;
  historyList.prepend(div);
}
function addMyRecordItem(original,replaced){
  if(!original || !replaced) return;
  const div=document.createElement('div');
  div.className='my-record-item';

  const textDiv=document.createElement('div');
  textDiv.className='myrecord-text';
  textDiv.textContent=`${original} â†’ ${replaced}`;

  const btnsDiv=document.createElement('div');
  btnsDiv.className='myrecord-btns';

  const btnEdit=document.createElement('button');
  btnEdit.className='btn-edit';
  btnEdit.textContent='ìˆ˜ì •';
  btnEdit.addEventListener('click',()=>{
    const newOri=prompt('ì›ë˜ í…ìŠ¤íŠ¸ ìˆ˜ì •', original);
    if(newOri===null) return;
    const newRep=prompt('ë³€í™˜ í…ìŠ¤íŠ¸ ìˆ˜ì •', replaced);
    if(newRep===null) return;
    if(newOri.trim()&&newRep.trim()){
      textDiv.textContent=`${newOri.trim()} â†’ ${newRep.trim()}`;
    }
  });
  btnsDiv.appendChild(btnEdit);

  const btnDelete=document.createElement('button');
  btnDelete.className='btn-delete';
  btnDelete.textContent='ì‚­ì œ';
  btnDelete.addEventListener('click',()=>{ myRecordList.removeChild(div); });
  btnsDiv.appendChild(btnDelete);

  div.appendChild(textDiv);
  div.appendChild(btnsDiv);
  myRecordList.prepend(div);
}

convertBtn.addEventListener('click',()=>{
  const text=inputText.value.trim();
  if(!text){outputDiv.textContent='ë¬¸ì¥ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!';return;}
  let replaced=text;
  swearWords.forEach(word=>{
    const regex=new RegExp(word,'gi');
    replaced=replaced.replace(regex,()=>generateNewWord(wordLengthSelect.value));
  });
  outputDiv.textContent=replaced;
  btnAddMyRecord.style.display='inline-block';
  addHistoryItem(text,replaced);
});
btnAddMyRecord.addEventListener('click',()=>{
  addMyRecordItem(inputText.value.trim(),outputDiv.textContent.trim());
  btnAddMyRecord.style.display='none';
});
myRecordAddBtn.addEventListener('click',()=>{
  if(myRecordInputOriginal.value && myRecordInputReplaced.value){
    addMyRecordItem(myRecordInputOriginal.value,myRecordInputReplaced.value);
    myRecordInputOriginal.value=''; myRecordInputReplaced.value='';
  }
});

function encodeRecordsShort(records){
  return btoa(unescape(encodeURIComponent(records.join('\n'))))
    .replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,'');
}
function decodeRecordsShort(str){
  try{return decodeURIComponent(escape(atob(str.replace(/-/g,'+').replace(/_/g,'/')))).split('\n');}
  catch(e){return [];}
}
btnCopyMyRecords.addEventListener('click',()=>{
  if(myRecordList.children.length===0){alert('ë‚´ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.');return;}
  const records=[]; for(let item of myRecordList.children){records.push(item.querySelector('.myrecord-text').textContent);}
  const recordId=encodeRecordsShort(records);
  const nickname=nicknameInput.value.trim();
  const url=location.origin+location.pathname+'?myRecords='+recordId+(nickname?'&nickname='+encodeURIComponent(nickname):'');
  navigator.clipboard.writeText(url).then(()=>alert('ë‚´ ê¸°ë¡ URLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!')).catch(()=>alert('ë³µì‚¬ ì‹¤íŒ¨'));
});
window.addEventListener('load',()=>{
  const params=new URLSearchParams(location.search);
  const rec=params.get('myRecords'); const nick=params.get('nickname');
  if(nick){ document.querySelector('h1').textContent=`ğŸ’¥ ${nick}ì˜ ìš•ì„¤ ë³€í™˜ê¸° ğŸ’¥`; }
  if(rec){
    const stored=decodeRecordsShort(rec);
    stored.forEach(line=>{
      const idx=line.indexOf('â†’');
      if(idx!==-1){
        const o=line.slice(0,idx).trim();
        const r=line.slice(idx+1).trim();
        if(o&&r) addMyRecordItem(o,r);
      }
    });
  }
});
</script>
</body>
</html>
