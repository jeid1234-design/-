<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>💥 욕설 변환기 💥</title>
<style>
  html, body {
    width: 100%;
    min-height: 100vh;
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  body {
    background: linear-gradient(135deg, #74b9ff, #a29bfe);
    min-height: 100vh;
    width: 100vw;
    color: #2c3e50;
    overflow-y: auto;
  }
  .container {
    display: flex;
    min-height: 100vh;
    max-width: 1100px;
    margin: 0 auto;
    background: #ffffffdd;
    backdrop-filter: blur(6px);
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.15);
  }
  .left-pane { flex: 1.5; padding: 40px 35px; display: flex; flex-direction: column; align-items: center; border-right: 2px solid #d2d2d2; }
  .right-pane { flex: 1; display: flex; flex-direction: column; padding: 40px 35px; }
  h1 { font-size: 30px; margin-bottom: 15px; text-align: center; }
  p { font-size: 16px; margin-bottom: 30px; text-align: center; }
  textarea {
    width: 100%; padding: 14px; margin-bottom: 20px; font-size: 16px;
    border: 2px solid #dfe6e9; border-radius: 10px; resize: vertical; outline: none; min-height: 100px;
  }
  textarea:focus { border-color: #0984e3; }
  .controls { display: flex; gap: 12px; align-items: center; margin-bottom: 25px; }
  select {
    padding: 8px 12px; font-size: 15px; border-radius: 8px; border: 1px solid #b2bec3;
  }
  button {
    font-size: 16px; font-weight: bold;
    background: linear-gradient(90deg, #0984e3, #6c5ce7);
    color: #fff; border: none; border-radius: 10px; cursor: pointer;
    padding: 12px 20px;
    transition: 0.2s;
  }
  button:hover { transform: translateY(-2px); box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
  #output-wrapper { margin-top: 30px; width: 100%; }
  #output { font-size: 24px; font-weight: bold; color: #0984e3;
    background: #f1f2f6; padding: 18px; border-radius: 10px; min-height: 60px; }
  .history-section { margin-bottom: 24px; display: flex; flex-direction: column; }
  .history-title { font-weight: bold; font-size: 18px; margin-bottom: 12px; border-bottom: 2px solid #636e72; padding-bottom: 6px; }
  /* 내 기록 입력폼 */
  #my-records-form { display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px; }
  #my-records-form input[type="text"] {
    padding: 9px 12px; font-size: 14px; border: 1px solid #b2bec3; border-radius: 8px;
  }
  #my-records-btns { display: flex; gap: 8px; }
  #my-record-list, #history-list {
    margin-top: 10px;
    padding: 10px;
    background: #f9fbff;
    border-radius: 10px;
    min-height: 60px;
    max-height: 150px;
    overflow-y: auto;
  }
  .my-record-item, .history-item {
    border-bottom: 1px solid #eee;
    padding: 6px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .my-record-item:last-child, .history-item:last-child { border-bottom: none; }
  .myrecord-text { flex: 1; word-break: break-all; margin-right: 10px; }
  .myrecord-btns { display: flex; gap: 6px; flex-shrink: 0;}
  .btn-edit, .btn-delete {
    font-size: 13px; padding: 5px 12px; border-radius: 6px; border: none; cursor: pointer; color: #fff;
  }
  .btn-edit { background: #0984e3; }
  .btn-edit:hover { background: #6c5ce7; }
  .btn-delete { background: #d63031; }
  .btn-delete:hover { background: #b32020; }
  /* 모바일 */
  @media (max-width: 480px){
    .container { flex-direction: column; width: 100vw; border-radius: 0; }
    .left-pane, .right-pane { width: 100%; padding: 20px; border: none; }
    #output { font-size: 18px; }
  }
</style>
</head>
<body>
<div class="container">
  <div class="left-pane">
    <h1>💥 욕설 변환기 💥</h1>
    <p>내가, 너가, 그리고 우리가 만들어 가보자구 🎶</p>
    <textarea id="inputText" placeholder="여기에 문장을 입력해 보세요..."></textarea>
    <div class="controls">
      <label for="wordLengthSelect">글자 수:</label>
      <select id="wordLengthSelect">
        <option value="random">무작위</option>
        <option value="1">1글자</option>
        <option value="2">2글자</option>
        <option value="3">3글자</option>
        <option value="4">4글자</option>
      </select>
      <button id="convertBtn">🚀 변환하기</button>
    </div>
    <div id="output-wrapper">
      <div>✨ 결과:</div>
      <div id="output"></div>
      <button id="btn-add-my-record" style="display:none;">➕ 내 기록에 추가하기</button>
    </div>
  </div>
  <div class="right-pane">
    <div class="history-section">
      <div class="history-title">📋 내 기록</div>
      <div id="my-records-form">
        <input type="text" id="nicknameInput" placeholder="닉네임 (예: 철수)" />
        <input type="text" id="my-record-input-original" placeholder="원래 욕설 입력" />
        <input type="text" id="my-record-input-replaced" placeholder="변환어 입력" />
        <div id="my-records-btns">
          <button id="my-record-add-btn">➕ 추가</button>
          <button id="btn-copy-my-records">📎 내 기록 URL 복사하기</button>
        </div>
      </div>
      <div id="my-record-list"></div>
    </div>
    <div class="history-section">
      <div class="history-title">📝 변환 기록</div>
      <div id="history-list"></div>
    </div>
  </div>
</div>

<script>
const swearWords = ['씨발','씨발년','시발','시발년','개새끼','병신','존나','썅','개좆같네','좆같네','좆','느금마','니미','좇같네','개좇같네','좇같은','좇만이','좆만이'];
const onsetConsonants=['ㅋ','ㅍ','ㅅ','ㅈ','ㄱ','ㄷ','ㅂ','ㄴ','ㄹ'];
const vowels=['ㅏ','ㅓ','ㅗ','ㅜ','ㅡ','ㅣ','ㅐ','ㅔ','ㅚ','ㅘ','ㅙ'];
const codaConsonants=['','ㄱ','ㄴ','ㅁ','ㅇ','ㅂ','ㄹ'];
function makeHangulSyllable(cho,jung,jong){
  const choList=['ㄱ','ㄲ','ㄴ','ㄷ','ㄸ','ㄹ','ㅁ','ㅂ','ㅃ','ㅅ','ㅆ','ㅇ','ㅈ','ㅉ','ㅊ','ㅋ','ㅌ','ㅍ','ㅎ'];
  const jungList=['ㅏ','ㅐ','ㅑ','ㅒ','ㅓ','ㅔ','ㅕ','ㅖ','ㅗ','ㅘ','ㅙ','ㅚ','ㅛ','ㅜ','ㅝ','ㅞ','ㅟ','ㅠ','ㅡ','ㅢ','ㅣ'];
  const jongList=['','ㄱ','ㄲ','ㄳ','ㄴ','ㄵ','ㄶ','ㄷ','ㄹ','ㄺ','ㄻ','ㄼ','ㄽ','ㄾ','ㄿ','ㅀ','ㅁ','ㅂ','ㅄ','ㅅ','ㅆ','ㅇ','ㅈ','ㅊ','ㅋ','ㅌ','ㅍ','ㅎ'];
  return String.fromCharCode(0xAC00+choList.indexOf(cho)*21*28+jungList.indexOf(jung)*28+jongList.indexOf(jong));
}
function generateNewWord(lengthOption){
  let wordLength=(lengthOption==='random')?Math.floor(Math.random()*4)+1:parseInt(lengthOption);
  if(isNaN(wordLength)||wordLength<1) wordLength=2;
  let word='';
  for(let i=0;i<wordLength;i++){
    const cho=onsetConsonants[Math.floor(Math.random()*onsetConsonants.length)];
    const jung=vowels[Math.floor(Math.random()*vowels.length)];
    const jong=(i===wordLength-1&&Math.random()<0.5)?codaConsonants[Math.floor(Math.random()*codaConsonants.length)]:'';
    word+=makeHangulSyllable(cho,jung,jong);
  }
  return word;
}
const inputText=document.getElementById('inputText');
const wordLengthSelect=document.getElementById('wordLengthSelect');
const convertBtn=document.getElementById('convertBtn');
const outputDiv=document.getElementById('output');
const btnAddMyRecord=document.getElementById('btn-add-my-record');
const historyList=document.getElementById('history-list');
const myRecordList=document.getElementById('my-record-list');
const myRecordInputOriginal=document.getElementById('my-record-input-original');
const myRecordInputReplaced=document.getElementById('my-record-input-replaced');
const myRecordAddBtn=document.getElementById('my-record-add-btn');
const btnCopyMyRecords=document.getElementById('btn-copy-my-records');
const nicknameInput=document.getElementById('nicknameInput');

function addHistoryItem(original,replaced){
  const div=document.createElement('div');
  div.className='history-item';
  div.innerHTML=`${original} → <span>${replaced}</span>`;
  historyList.prepend(div);
}
function addMyRecordItem(original,replaced){
  if(!original || !replaced) return;
  const div=document.createElement('div');
  div.className='my-record-item';

  const textDiv=document.createElement('div');
  textDiv.className='myrecord-text';
  textDiv.textContent=`${original} → ${replaced}`;

  const btnsDiv=document.createElement('div');
  btnsDiv.className='myrecord-btns';

  const btnEdit=document.createElement('button');
  btnEdit.className='btn-edit';
  btnEdit.textContent='수정';
  btnEdit.addEventListener('click',()=>{
    const newOri=prompt('원래 텍스트 수정', original);
    if(newOri===null) return;
    const newRep=prompt('변환 텍스트 수정', replaced);
    if(newRep===null) return;
    if(newOri.trim()&&newRep.trim()){
      textDiv.textContent=`${newOri.trim()} → ${newRep.trim()}`;
    }
  });
  btnsDiv.appendChild(btnEdit);

  const btnDelete=document.createElement('button');
  btnDelete.className='btn-delete';
  btnDelete.textContent='삭제';
  btnDelete.addEventListener('click',()=>{ myRecordList.removeChild(div); });
  btnsDiv.appendChild(btnDelete);

  div.appendChild(textDiv);
  div.appendChild(btnsDiv);
  myRecordList.prepend(div);
}

convertBtn.addEventListener('click',()=>{
  const text=inputText.value.trim();
  if(!text){outputDiv.textContent='문장을 입력해주세요!';return;}
  let replaced=text;
  swearWords.forEach(word=>{
    const regex=new RegExp(word,'gi');
    replaced=replaced.replace(regex,()=>generateNewWord(wordLengthSelect.value));
  });
  outputDiv.textContent=replaced;
  btnAddMyRecord.style.display='inline-block';
  addHistoryItem(text,replaced);
});
btnAddMyRecord.addEventListener('click',()=>{
  addMyRecordItem(inputText.value.trim(),outputDiv.textContent.trim());
  btnAddMyRecord.style.display='none';
});
myRecordAddBtn.addEventListener('click',()=>{
  if(myRecordInputOriginal.value && myRecordInputReplaced.value){
    addMyRecordItem(myRecordInputOriginal.value,myRecordInputReplaced.value);
    myRecordInputOriginal.value=''; myRecordInputReplaced.value='';
  }
});

function encodeRecordsShort(records){
  return btoa(unescape(encodeURIComponent(records.join('\n'))))
    .replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,'');
}
function decodeRecordsShort(str){
  try{return decodeURIComponent(escape(atob(str.replace(/-/g,'+').replace(/_/g,'/')))).split('\n');}
  catch(e){return [];}
}
btnCopyMyRecords.addEventListener('click',()=>{
  if(myRecordList.children.length===0){alert('내 기록이 없습니다.');return;}
  const records=[]; for(let item of myRecordList.children){records.push(item.querySelector('.myrecord-text').textContent);}
  const recordId=encodeRecordsShort(records);
  const nickname=nicknameInput.value.trim();
  const url=location.origin+location.pathname+'?myRecords='+recordId+(nickname?'&nickname='+encodeURIComponent(nickname):'');
  navigator.clipboard.writeText(url).then(()=>alert('내 기록 URL이 복사되었습니다!')).catch(()=>alert('복사 실패'));
});
window.addEventListener('load',()=>{
  const params=new URLSearchParams(location.search);
  const rec=params.get('myRecords'); const nick=params.get('nickname');
  if(nick){ document.querySelector('h1').textContent=`💥 ${nick}의 욕설 변환기 💥`; }
  if(rec){
    const stored=decodeRecordsShort(rec);
    stored.forEach(line=>{
      const idx=line.indexOf('→');
      if(idx!==-1){
        const o=line.slice(0,idx).trim();
        const r=line.slice(idx+1).trim();
        if(o&&r) addMyRecordItem(o,r);
      }
    });
  }
});
</script>
</body>
</html>
